# 剖析WordProcessingML文件
## 打包结构
一个WordprocessingML文件或者`docx`文件都是一个zip文件（一个打包文件），通常包含一许多UTF-8或UTF-16格式的XML文件，和一些严格定义的字节流文件。这个包还可以包含其他媒体文件，例如图像和视频。该结构根据开放式打包公约进行组织。

您只需将任何docx文件重命名zip并解压缩，即可查看文件结构和文件内容。
![](./images/zipFile1.gif)

## 内容类型
每个包都必须有一个`[Content_types].xml`，位于包的根目录下。此文件包含包中所有部件的内容类型的列表。每个部分及其类型必须列在[Content_types].xml中。以下是主要文档部分的内容类型：
```
<Override PartName="/word/document.xml" ContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml"/>
```

再将新的部件添加到此包中，请牢记这一点

## 关联
每个包都包含一个关系部分，用于定义其他部分与包外部资源之间的关联。这部分将引用与内容分离，使得在不更改引用目标的源的情况下更改关系变得容易。

![](./images/zipFile2.gif)

对于OOXML包，_rels目录中始终存在关系部分(.rels)，用于标识包的起始部分或包关系。例如，以下内容定义了内容的开始部分的标识：
```
<Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" Target="word/document.xml"/>
```
.rels中通常也存在app.xml和core.xml的关联

除了包的关联部分之外，每个部分的源具有一个或多个关联也将具有其自己的关联部分。每个关联部分都在部件的_rels子文件夹中找到，并将以部件名称+`.rels`结尾来命名。通常，主要内容部分（document.xml）具有自己的关联部分。它将包含与内容其他部分的关系，例如styles.xml，themes，xml和footer.xml，以及外部链接的URI。

![](./images/zipFile3.gif)

关联可以是显示的，也可以是隐式的。对于显示关系，使用`<Relationship>`元素的`Id`属性引用资源。即说明，这个`Id`在源中直接映射到Id关联的项目，与显示引用到目标。

例如，文档可能包含如下的超链接：
```
<w:hyperlink r:id="rId4">
```
这个r:id="rId4"证明了以下document文档中的关联部分(document.xml.rels)
```
<Relationship Id="rId4" Type="http://. . ./hyperlink" Target="http://www.google.com/" TargetMode="External"/>
```

在一个隐式关联中，没有对`<Relationship>`Id的直接引用。相反，参考将被解释。例如，文档可能包含对脚注的引用。如下所示：
```
<w:footnoteReference r:id="2">
```
在这个示例中，r:id="2"是脚注的引用，被解释为在脚注部分（如果它存在）。在脚注部分，我们将看到以下内容：
```
<w:footnote w:id="2">
```

## WordprocessingML文档特性
下面是WordprocessingML包的特定于WordprocessingML文档的可能部件的列表。请记住，文档可能只包含其中的一部分。例如，如果文档没有脚注，则脚注部分将不包含在包中。

|部件|描述|
|---|---|
|注释|包含文档中的注释。如果有词汇表，可能会有主文档的注释部分和词汇表的注释部分。|
|文档设置|指定文档的设置，包括是否隐藏拼写和语法错误，跟踪修订，写保护等。如果有词汇表，则可能有主文档的文档设置部分和词汇表的文档设置部分。|
|尾注|包含文档的尾注。如果有词汇表，主文档可能有一个尾注部分，词汇表可能有一个尾注部分。|
|字体表|指定有关文档中使用的字体的信息。应用程序将使用部件中的信息来确定在系统上没有指定字体时用于显示文档的字体。如果有词汇表，则可能有主文档的字体表和词汇表的字体表。|
|页脚|包含[页脚](./footers)的信息。请注意，文档的每个[章节](./section)可能包含第一页，奇数页和偶数页的页脚。所以可能有多个页脚部分，这取决于document中有多少章节以及章节的页脚类型|
|脚注|包含文档的脚注。如果有词汇表，主文档可能有一个脚注部分，词汇表可能有一个脚注部分。|
|词汇表|这是一个补充文档存储位置，它可能包含随文档一起提供但在主文档内容中不可见的内容。它用于存储可选的文档片段。只允许一个。|
|页眉|包含[页眉](./headers)的信息。请注意，文档的每个[章节](./section)可能包含第一页，奇数页和偶数页的标题。因此，可能有多个标题部分，具体取决于documnet中有多少部分以及部分的标题类型。|
|主要文档|包含文档的正文|
|编号定义|包含文档中每个[编号定义](./numbering)的结构定义。如果有词汇表，则可能有主文档的编号定义部分和词汇表的编号定义部分。|
|样式定义|包含文档使用的一组[样式](./styles)的定义。如果有词汇表，则可能有主文档的样式定义部分和词汇表的样式定义部分。|
|网页设置|包含文档使用的特定于Web的设置的定义。这些设置指定两个类别：可以在WordprocessingML文档中使用的与HTML文档相关的设置（即框架集定义），以及在保存为HTML时影响文档处理方式的设置。如果有词汇表，则可能有主文档的Web设置部分和词汇表的Web设置部分。|

## 其他OOXML文档共享的部件
任何OOXML包中都可能出现许多部件类型。下面是WordprocessingML文档的一些更相关的部分。

|部件|描述|
|--|--|
|嵌入式包|包含引用包内部或外部的完整包。例如，WordprocessingML文档可能包含电子表格或演示文稿文档。|
|扩展文件属性（通常位于docProps/app.xml）|包含特定于OOXML文档的属性 - 属性，例如使用的模板，页面和单词的数量，以及应用程序名称和版本。|
|文件属性，核心|核心文件属性使用户能够在包中发现和设置公共属性 - 属性，例如创建者名称，创建日期，标题。尽可能使用[Dublin Core](http://dublincore.org/) 属性（用于描述资源的一组元数据术语）。|
|字形|包含直接嵌入到文档中的字体。字体可以存储为位图字体，其中每个字形存储为光栅图像，或者格式符合ISO/IEC 14496-22:2007。|
|图片|文档通常包含图像。图像可以作为zip项存储在包中。必须通过图像部件关系和适当的内容类型来标识该项目。|
|主题|DrawingML是OOXML文档类型的共享语言。它包括一个主题部分，当文档使用主题时，它包含在WordprocessingML文档中。主题部分包含有关文档主题的信息，即颜色方案，字体和格式方案等信息。|

